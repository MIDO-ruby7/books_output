# 第2章 暗号技術
## 暗号とは
- 「暗号化という特殊な処理（アルゴリズム、表記法）」と「処理後のデータ（表記）」の２つの意味がある
- 平文（へいぶん、ひらぶん）
- シーザー暗号：最も古い。アルファベットを決めた数だけ後ろにずらす。
- 「アルファベットを３文字後ろにずらす。」とすると、「アルファベットを決めた数だけ後ろにずらす」が暗号アルゴリズム、「3文字」が暗号化鍵
- バーナム暗号：1900年代初期。乱数列を使用。
- バーナム暗号の問題点：
  ①２者間で乱数列を共有する必要があるが相手に暗号化鍵を安全に届けることが困難
  ②暗号化鍵を再利用できない。
  ③厳密な意味での乱数列を作るのは簡単ではない。コンピューターは疑似乱数を作り出していて規則性がある。

### 共通鍵暗号化方式と公開暗号化方式
- 共通鍵暗号化方式は暗号化鍵と復号鍵が同一である暗号化方式
- 共通鍵暗号化方式では、暗号化鍵および復号鍵を2者間で1つずつ共有する方法  が重要な問題だった
- 鍵配布方法としてKerberosなど代表的なものが考えられたが、不特定多数の利用には向いていなかった
- そこで出てきたのがRSA。特徴は暗号化鍵と復号鍵を別々にしたこと
- RSAのような暗号化方式を公開暗号化方式

### 共有鍵暗号化技術
- ブロック暗号化(例：DES,AES)とストリーム暗号化(例：RC4、 ChaCha20)に大別できる
- ブロック暗号化方式は、 データ撹拌部と鍵生成部とから構成され、暗号化をブロック単位で行う
- ストリーム暗号化方式は、擬似乱数生成器が生成する乱数を使い、入力された平文をビット単位で暗号化する
- DES（Data Encryption Standard）：Festel構造と呼ばれる構成法をもつ。64ビットのブロック単位で平文を暗号化。現在は安全性が疑問視されており利用を避ける
- 3DESはDESを３かい行うことで暗号強度を高めた方式
- AES（Advanced Encryption Standard）：SPN構造が採用されており、Festel構造より高速処理が期待できる。ブロック暗号の中では最も安全であるとされ、利用が推奨されている
- RC4(Rivest Cipher 4)：多用されていたがAESがあるので現在では推奨されない
- ChaCha20：比較的新しいストリーム暗号の一種

### 公開鍵暗号化技術
- RSAはディジタル署名にも使われる
- 512,1024,2048,4096ビットがあるが、より安全性を求めるのでああれば2048の利用を推奨
- 演算に時間がかかるため処理速度は遅い。そのため、共通鍵暗号化方式と公開暗号化方式の両方を使用したハイブリッド暗号方式もある。
- ハイブリッド暗号において一時的に用意される暗号化鍵をセッション鍵と呼ぶ

### ハッシュ関数とディジタル署名
- ハッシュ関数とは、 任意の長さのデータを固定長 （128～512ビット程度） のデータに圧縮する関数。方向性、第２現像計算困難性、衝突困難性の性質を持つ
- ハッシュ関数によって生成された値をハッシュ値（メッセージダイジェスト、フィンガープリント）
- ハッシュ関数の具体例としては、 MD4、 MD5、 SHA、 SHA-1、 SHA-2、 SHA-3  などがある
- ハッシュ関数は秘密情報の保存や改善検知で利用されている。
- パスワード認証：ログイン時にパスワードを入力するとその度に入力にタウするハッシュ値が計算され保存されているハッシュ値と比較される
- ファイルの改善検知：改ざんを検知したいファイル・ファイル群のハッシュ値を作成し、その後ファイルの改竄があるか確認をしたい時いファイルのハッシュ値を再度作成する。その値と最初に保存したハッシュ値を比較する。両者が同じなら改ざんはない。違っていたら改ざんされたとみなす
- メッセージ改ざん検知（MAC）：MACとは送信するメッセージmと共通化ぎ暗号化方式の暗号鍵Kとに、ハッシュ関数hashを適用して作るMACという不可情報のみど言うな値（MAC値）。MAC値と送信するメッセージmを合わせて送ることにより、送信するメッセージmの神聖性と完全性を保証する

### ディジタル署名
- ディジタル署名とは、メッセージに対するハッシュ値を秘密鍵で暗号化すること
- メッセージの改ざん検知、避妊防止を実現する仕組み
- ディジタル署名を生成することを書名と呼ぶ
- 署名が有効であることを確認することを書名の検証と呼ぶ
- 署名処理から検証処理までのディジタル署名の一連の流れ
 (①～④が署名の作成フェーズ、 ⑤～⑧が検証フェーズ)
  ① 署名者（文書作成者） はあらかじめ公開鍵Pと秘密鍵Sを用意し、公開鍵を  署名の検証者に安全に渡しておく
  ② ハッシュ関数を用いて、送信したい平文Mのハッシュ値Hを求める
  ③ 署名者はあらかじめ用意しておいた秘密鍵Sを用いて、ハッシュ値Hを暗号化する
  ④ 平文であるメッセージMと署名値HS をセットで検証者に送る
  ⑤ 検証者は、平文Mからハッシュ値H を求める
  ⑥ 署名者の発行した公開鍵Pを用いて署名値HSを復号し、ハッシュ値Hを求める。ここで、秘密鍵Sで暗号化したデータは秘密鍵Sとペアとなる公開鍵  Pでしか復号できない点に注意
  ⑦ 検証者は、 署名から求めたハッシュ値HとメッセージMから求めたH が一  致するかどうかを確認する
  ⑧ 一致した場合、メッセージMは署名者によって作成されたことを確認でき  る。 一致しない場合、なんらかの攻撃があったとみなしメッセージを不正  なものとする
  [![Image from Gyazo](https://i.gyazo.com/452003151be41c1cfa6a23e9a22e80a4.png)](https://gyazo.com/452003151be41c1cfa6a23e9a22e80a4)

### 暗号技術における安全性
- 透過安全性：対象とする暗号技術に対して最も効率的な攻撃をおこなたさいに、解読に必要となる計算量を評価
- ８０ビット安全性以上であれば、数年以内の単位は解読できないが、今後はどうなるかわからないため112ビット以上に移行する旨がガイドラインで勧告された